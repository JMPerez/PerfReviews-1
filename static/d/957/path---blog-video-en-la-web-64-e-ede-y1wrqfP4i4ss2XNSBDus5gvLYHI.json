{"data":{"site":{"siteMetadata":{"title":"PerfReviews","author":"Joan Le√≥n y Jos√© M. P√©rez"}},"markdownRemark":{"id":"d85f5c2c-3320-530a-bfab-a21a442f9b07","excerpt":"Despu√©s de este tweet de  Yoav Weiss  en el que  Addy Osmani  le pregunta por la ‚Äúmejor‚Äù imagen de la web. Rick Viscomi  es un ingeniero de Google que‚Ä¶","html":"<p>Despu√©s de este tweet de <a href=\"https://twitter.com/yoavweiss\">Yoav Weiss</a> en el que <a href=\"https://twitter.com/addyosmani\">Addy Osmani</a> le pregunta por la ‚Äúmejor‚Äù imagen de la web.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/28cbb92632f50d041418b0179574a14a/7bfa5/Yoav.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 1240px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 114.51612903225808%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAAsSAAALEgHS3X78AAAC00lEQVQ4y4VU2XabMBDlq9v+RR/70H9pTvrU0zjxlhAvTWwMGCM2CYlFIEEvUPvEjtvqjA1IM5o7c69kKK1t28nyvCxLkYm6rpu27Qzj9HJ6P5puGpjh++TDx0/fbm42lj2ezmNK2z6g/eeAA7IaeZ7f3n5393susoQxLkSaplkGKDnn+MoopbwfjLEkgQsDxiHewOxytZrOZtPZ/O5uNBrdjyeTx6cn03z+8fPnZDp7eBiP7u+xNJlMN5ut4zi0R9fBllXlOs52u42iCMU7jkvC8OD7wALbe55PyN7bYyUMwwvkRqWbQLapaiPZ6rb9b6nH9vXBqJvnRcJSyjhlaVeYKFmpgCgvZZYXUlZFKRX8tG7eDHwZulbuxjYXy+VqaT4vzMf5w2IztwPiuiEJRV4gkqb8ov/4wl5dMEWVURyFURAEcRz7By8gJDj4IqFVVSmlruHvg5VuKE8RRvALQ5CBzmGLMIqCKELP8iw7Vfs+WAck9DwPsa7rkmH4xDug5QR/MKyCBex70s8Rtq4bTZGKUZaAQcbwjiekgmIgmbZN/w5bqTgOQCNIRgbL2h0OB0CwdjuQ7ncwPHQAJGc9/rPgWilrZ6/Xv143m5eXl61lQX2oMxOiLLqRDuIUQkp5peayxHwF3mRVV3XHaK1bWKVb1VwXSTOcKjjTVIg8B58sFaCUZ7kv6j2vbVaFOXhq9BthnckTSkJzEID0CVSWdbucOb235s85N3D6Uy54dxlIZE1FFz2c9T5hDxViuLJFYwxgUGhV1UMejKwo66OwdFaWs9fmyDBwycGzOxhNs7MtxjkkxSj145Rkqiw6TZeygiesrVV7fgF1hm6nUn798nm6MJ+X69n8cWyu7hxuOtHaS1ALLhR0sT9R+qJbA1UK1wbSdtoO8ISePY+Ezt4jlh34mA593x+unstuD5WgQnRqKB4Na3t+5NLWosBy10LdvA/+DWEhJHVi7c7+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/28cbb92632f50d041418b0179574a14a/277cf/Yoav.webp 310w,\n/static/28cbb92632f50d041418b0179574a14a/5077d/Yoav.webp 620w,\n/static/28cbb92632f50d041418b0179574a14a/e1adb/Yoav.webp 1240w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/28cbb92632f50d041418b0179574a14a/fa223/Yoav.png 310w,\n/static/28cbb92632f50d041418b0179574a14a/a5ed1/Yoav.png 620w,\n/static/28cbb92632f50d041418b0179574a14a/7bfa5/Yoav.png 1240w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/28cbb92632f50d041418b0179574a14a/7bfa5/Yoav.png\"\n          alt=\"Tweet Yoav & Addy\"\n          title=\"\"\n          src=\"/static/28cbb92632f50d041418b0179574a14a/7bfa5/Yoav.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    </p>\n<p><a href=\"https://twitter.com/rick_viscomi\">Rick Viscomi</a> es un ingeniero de Google que actualmente est√° trabajando en un interesante proyecto llamado ‚ÄúThe State of the Web‚Äù. Para esta iniciativa, Rick est√° ejecutando cientos de consultas con <a href=\"https://cloud.google.com/bigquery/\">BigQuery</a> contra el dataset de <a href=\"https://httparchive.org\">HTTP Archive</a>, y responde a Addy con el siguiente tweet:</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/161f746459bb8584f488b60edda996c1/7bfa5/Rick.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 1240px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 106.4516129032258%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAAsSAAALEgHS3X78AAACIElEQVQ4y41UyW7bMBDV/wM99tx7i/ZU9DMKtEAW20ltWSttbTZ3cVEfJStxk7jOw2A8Ivg4nDdDR9tk8+3jh/Vyebd8uLm53Wzi4R1w3sMiLuX6ccUY51LvmCHMVsLuuSXcNtLBWuXe5PthiJTSq8c/t3f32zTFtqN2vHeidwzeeGmDXSR774UQnDMp5eD9awOce2kBg48QgVznhNZVr8S8/4SpttcAyzofWecEF2maJUmitTLPsEabkOCSZhOZMVZmJN5u8zwvZ+x2O1ISSukV8vFIN4s4WSe0riUX1tqQNyD4a5mVIqQtSc075owd3oeRbEx187v69ZOtH5AKmiMtvNa673toCY+Yc65HTCsAbhUZpfLvX+LPn4ofXxllZUnA3O/3RxRDaVEUoLVtiwDrUAcB+Ah6YyLnh6rtqq7r2NjqC8ARkBCnQIVmRCAj+2KxSNOUlCUSHmbUdT3lnz4JIVmWwcdxvFqt4MdrW5fnBZqMPoGPW2FTluew0LmiHH9zbJha2MzACEBt3zQtPpRSVxWeRnYKTq2CtNAOJqRiHE4ftD9I10kremz/Z2An5ulh4AAmhAp9MUxILkPYKTxGW0uLR3ZKOLxhERRuIPURUiuy2x8ox1kvnt65nS+GayOnRMVhBHoUgB7A3PTqMEmop6V+zg+B3Xj7INhUBmYZtOeuCoktpzGkQt8nw1wryjLjCE/k4enZPf0FnMf/sb+5r8GIQXe2/QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/161f746459bb8584f488b60edda996c1/277cf/Rick.webp 310w,\n/static/161f746459bb8584f488b60edda996c1/5077d/Rick.webp 620w,\n/static/161f746459bb8584f488b60edda996c1/e1adb/Rick.webp 1240w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/161f746459bb8584f488b60edda996c1/fa223/Rick.png 310w,\n/static/161f746459bb8584f488b60edda996c1/a5ed1/Rick.png 620w,\n/static/161f746459bb8584f488b60edda996c1/7bfa5/Rick.png 1240w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/161f746459bb8584f488b60edda996c1/7bfa5/Rick.png\"\n          alt=\"Tweet Rick\"\n          title=\"\"\n          src=\"/static/161f746459bb8584f488b60edda996c1/7bfa5/Rick.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Rick muestra la consulta SQL que ha hecho a la tabla de la base de datos con los datos de HTTP Archive del mes de julio.</p>\n<p>La ‚Äúmejor‚Äù imagen de la web actualmente es un archivo en formato GIF, video.gif. Como su nombre indica, se trata de un v√≠deo de 11 segundos y con un tama√±o de m√°s de <strong>65MB</strong>.</p>\n<p>S√≠, nos pudo la curiosidad üòä</p>\n<p>As√≠ que empezamos a hacer eso que tanto nos gusta hacer, investigar para conseguir encontrar el problema y su posible soluci√≥n.</p>\n<h2 id=\"problema\">Problema</h2>\n<p>Al ver la url de la imagen, lo primero que podemos ver es que se trata de un <a href=\"https://moodle.org\">Moodle</a>, una plataforma de aprendizaje en l√≠nea utilizada por muchas escuelas de todo el mundo.</p>\n<p>Al entrar en la direcci√≥n <a href=\"https://moodle.e-formalia.es\">moodle.e-formalia.es</a> nos encontramos con una p√°gina de acceso a la plataforma, y ah√≠ es donde encontramos el tan pesado GIF.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7a0242c50970cf62c34468bd6dea54a4/140d6/home.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 1240px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 59.2814371257485%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAACsklEQVQoz2PoWbhs3f4ja/cdWrXn4Kr9R1sWry6YNCeitMIlOro2KWpZQWxPsGdPZtaCorhtfaV7lkzbv3HNob17Dh84cHj3ToYNB468//ju9bv3z168+Pbz5/rd+9du3z1t0eLK7t721Lg6N+tsX/cllambqxPWVcZuacnY2V++Y1Ltxq7yWUWJDBsOHv306eOzV6/fvP/w8fOXM6dOnzx69Myx46eOHe/LTW/wsl9VELs4O2xKlM/02IDp6eHTc6Nn5EV3JQVXR/gzbD12+uOHj58+f/71+9f3799PHjt2aM/uAzu2Hd2/Z251cbuPc7mbo5+RkbehYb6TXZ2fe3OYX2Okf2WIX76/J8OhE+fuPXj08dOXr9+/f/327fjBA/u3b9uzcf3udatn9XUnuTn56eh5GxiZa+tZghnJdjZpHu4hrh4Bbl4MB/fsvnf71rvXL758ePv1w/srp09eOHb03MF9+9aumjdhQkdxSXdmente9sTyou6ivCnV5ct7OlZO6l0+eeLGubMZKhtqaloaqpoaqhrrqppbqts6qts6q1raKhua8ovLSsrLq+vqKirKy8rLSktLyysqaurrKmpqyqurq+rqGQQMrfkNrYCIz8BS1Nha3MQWyOA3sBQ2shY0tuYHkoY2AkYghoiJnYSZPVCloLENEAEFGWStnSFIxtpZy81P1zNA1sZZ083PwCdE1dlbzdlbxyNAxz1Awc5N1clL281f1sZFBqwYiBikLR3hSNXZS8PFR9rSSdPN19gvFKha3tZV09VXxclTwtxe2soJaAeyegZBVR0gElDRltA2UjG3E1bX41fWAiI+IKmiLaCqw6OoIalromnjrGBiJaFjDFEPQQz8ihpAxCuvJqVjpGXtKKltKAjUBhaEID4FdUktQ3ULOwktA34lDWQpAIXxKMH0V/n8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/7a0242c50970cf62c34468bd6dea54a4/277cf/home.webp 310w,\n/static/7a0242c50970cf62c34468bd6dea54a4/5077d/home.webp 620w,\n/static/7a0242c50970cf62c34468bd6dea54a4/e1adb/home.webp 1240w,\n/static/7a0242c50970cf62c34468bd6dea54a4/92eb6/home.webp 1860w,\n/static/7a0242c50970cf62c34468bd6dea54a4/d232f/home.webp 2480w,\n/static/7a0242c50970cf62c34468bd6dea54a4/8d80f/home.webp 3340w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/7a0242c50970cf62c34468bd6dea54a4/fa223/home.png 310w,\n/static/7a0242c50970cf62c34468bd6dea54a4/a5ed1/home.png 620w,\n/static/7a0242c50970cf62c34468bd6dea54a4/7bfa5/home.png 1240w,\n/static/7a0242c50970cf62c34468bd6dea54a4/b429f/home.png 1860w,\n/static/7a0242c50970cf62c34468bd6dea54a4/d03be/home.png 2480w,\n/static/7a0242c50970cf62c34468bd6dea54a4/140d6/home.png 3340w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/7a0242c50970cf62c34468bd6dea54a4/7bfa5/home.png\"\n          alt=\"Home e-Formalia\"\n          title=\"\"\n          src=\"/static/7a0242c50970cf62c34468bd6dea54a4/7bfa5/home.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    </p>\n<p>El servidor nos est√° sirviendo dos im√°genes: logos.png y video.gif. El tiempo de carga de ese v√≠deo de fondo en la pantalla de acceso, desde una conexi√≥n de fibra √≥ptica de <strong>600MB</strong> es de tan s√≥lo <strong>2,67 segundos</strong>.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3386e8063e1887c0285f0edef7b5ec66/a987b/network-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 1240px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 48.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABdElEQVQoz31Qi4rdIBTM/39boVDY3n2wmxiv0Wh8Jr6SqD25S8tCS4dhGI4ez3E6PlFOZ8ZYP+C3j/HtvR/xndwvQpFSyufrVAhhrVmds0ApFyF+3m6dc27bFrqwkc2IwN1lmsVIJnyHVwWXirB5XqSQevVeKu29N9at64YQ6tKxK/syLIjGRHIQ+UilhbOmemk8QVsszR81HCXl3FqrtZZSOOddiCnv9TxKzruEzdy6bZv3AYaEGFNK67rGGEFhppTSbz7nHELEI+7Q64siWE13TSeBkKGTmohl9P3pyTDqF7EKzoaeoWEePsAKvTinjVX963MnUR8YCWwCejadegEWI+XQg2lON2ccwYEzT/ABmWXvwmwDH/tbd2187PV46Hm0crZSHvrVPHhe2Eu7vl2qIKRrf6F+0U/zx5+l7udVgMT4Hf+j+T8o9bMZJpcZ404pZa0FhST1b4A3xlhjtHWz9kx56cKmzQZph5hTCiH8+Pb9F//QOEyuDdUQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/3386e8063e1887c0285f0edef7b5ec66/277cf/network-1.webp 310w,\n/static/3386e8063e1887c0285f0edef7b5ec66/5077d/network-1.webp 620w,\n/static/3386e8063e1887c0285f0edef7b5ec66/e1adb/network-1.webp 1240w,\n/static/3386e8063e1887c0285f0edef7b5ec66/92eb6/network-1.webp 1860w,\n/static/3386e8063e1887c0285f0edef7b5ec66/34ef4/network-1.webp 1920w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/3386e8063e1887c0285f0edef7b5ec66/fa223/network-1.png 310w,\n/static/3386e8063e1887c0285f0edef7b5ec66/a5ed1/network-1.png 620w,\n/static/3386e8063e1887c0285f0edef7b5ec66/7bfa5/network-1.png 1240w,\n/static/3386e8063e1887c0285f0edef7b5ec66/b429f/network-1.png 1860w,\n/static/3386e8063e1887c0285f0edef7b5ec66/a987b/network-1.png 1920w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/3386e8063e1887c0285f0edef7b5ec66/7bfa5/network-1.png\"\n          alt=\"Developer Tools: Network Panel\"\n          title=\"\"\n          src=\"/static/3386e8063e1887c0285f0edef7b5ec66/7bfa5/network-1.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Pero veamos qu√© pasa si utilizamos la funcionalidad del panel de red de las Developer Tools para simular una conexi√≥n m√°s lenta. Seleccionamos la configuraci√≥n de 3G r√°pida, que se acerca m√°s a la experiencia de carga en m√≥vil.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ae44d5483768a8b0262bf4e9680b1069/a987b/network-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 1240px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 48.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABa0lEQVQoz3WRiYrcMBBE9f//FlgIy+KQ8djWWIety5LVPiWlx0PCQnaL4lHtRqhbJgNnknPG2b2hv+uurm91QyntGGOccymluKhGZYyeQ/DBT1ppNVZVRdzkQwQf5oayhxg7Jvioup7dW6qMe3AxKN2LYTR2BpBK+zniEWtd3z/IcuZ5T3CWuKe9FCzXlOHMSyprLtharjIezy9IOPKx7SklYwxZlmW7tO+b9zjBjAYAbQy21m31IWAIAecDvBBiXJdnB1clbVUZ9jCst7h82yAxO8Fv7+/IWY1hlPxey65Fct67YHFqN5nu9ovo9g6iB8HQUbDTKnRyWjc1huJt8c73FCSfaGvGzm/KwzjBQJsPks8jHXs+Lp5HSWdJ6eLn8HQ6Tly2XMo5Wy5I+U/5E1/h5ZTzup+vKuekOfvi8HdKuWxH/nez7hnBF5+mCam1tn+F2V3C95c2ChMHB95NYRgWgHXb8Hf8/PH2B1T7OP9M1I/oAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/ae44d5483768a8b0262bf4e9680b1069/277cf/network-2.webp 310w,\n/static/ae44d5483768a8b0262bf4e9680b1069/5077d/network-2.webp 620w,\n/static/ae44d5483768a8b0262bf4e9680b1069/e1adb/network-2.webp 1240w,\n/static/ae44d5483768a8b0262bf4e9680b1069/92eb6/network-2.webp 1860w,\n/static/ae44d5483768a8b0262bf4e9680b1069/34ef4/network-2.webp 1920w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/ae44d5483768a8b0262bf4e9680b1069/fa223/network-2.png 310w,\n/static/ae44d5483768a8b0262bf4e9680b1069/a5ed1/network-2.png 620w,\n/static/ae44d5483768a8b0262bf4e9680b1069/7bfa5/network-2.png 1240w,\n/static/ae44d5483768a8b0262bf4e9680b1069/b429f/network-2.png 1860w,\n/static/ae44d5483768a8b0262bf4e9680b1069/a987b/network-2.png 1920w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/ae44d5483768a8b0262bf4e9680b1069/7bfa5/network-2.png\"\n          alt=\"Developer Tools: Network Panel\"\n          title=\"\"\n          src=\"/static/ae44d5483768a8b0262bf4e9680b1069/7bfa5/network-2.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Hemos tenido que esperar <strong>6,1 minutos</strong> para que se descargara el 100% del v√≠deo.</p>\n<h2 id=\"solucion\">Soluci√≥n</h2>\n<p>No es una novedad que el mejor formato para cargar un v√≠deo en la web es un fichero de v√≠deo como <strong>MP4</strong>, en lugar de una imagen con soporte de animaci√≥n como el formato GIF.</p>\n<p>Hay otros formatos de imagen con soporte de animaci√≥n, como <strong>WebM</strong>. Tambi√©n existe el formato <strong>APNG</strong>. Este formato, que no es nuevo pero es muy desconocido, es una versi√≥n de PNG con soporte para animaciones. Recientemente lo compart√≠a Joan en <a href=\"https://twitter.com/nucliweb/status/1163537269007032320\">este tweet</a>.</p>\n<p>Para aprender sobre el uso de utilizar V√≠deo en lugar de GIF, podemos hacer uso de una de las base de documentaci√≥n de buenas pr√°cticas, optimizaci√≥n y rendimiento web que tenemos disponible, <strong>Web Fundamentals</strong>. En este sitio web encontraremos un art√≠culo espec√≠fico sobre este tema <a href=\"https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/replace-animated-gifs-with-video/\">Replace Animated GIFs with Video</a>.</p>\n<p>En el art√≠culo nos sugieren una herramienta de compresi√≥n de v√≠deo, <a href=\"https://ffmpeg.org\">FFmpeg</a>. Se trata de una herramienta muy potente y vers√°til, con much√≠simas funcionalidades, plugins y configuraciones posibles. Pero vamos a hacerlo f√°cil, centr√°ndonos en las sugerencias que nos hace Google en art√≠culo mencionado.</p>\n<h3 id=\"mpeg-4\">MPEG-4</h3>\n<p>Despu√©s de la instalaci√≥n, en nuestro caso algo tan simple como <code class=\"language-text\">brew install ffmpeg</code> en Mac, ejecutamos <code class=\"language-text\">ffmpeg -i video.gif video.mp4</code> y despu√©s de unos pocos segundos podemos ver que el archivo <strong>video.gif</strong> de <strong>65MB</strong> se ha convertido en <strong>video.mp4</strong> de tan s√≥lo 6.6MB. En el art√≠culo nos muestran algunos par√°metros de FFmpeg que nos dan opci√≥n de optimizar la conversi√≥n desde el punto de vista de peso y de calidad.</p>\n<p>Podemos ajustar el par√°metro <a href=\"https://trac.ffmpeg.org/wiki/Encode/H.264\">CRF</a> que nos permite definir el nivel de p√©rdida de calidad. Tras algunas pruebas, optamos por definir el CRT a 22, un punto por debajo del valor por defecto, con la intenci√≥n de ser lo m√°s fieles posibles a la calidad que nos hemos encontrado con el fichero original.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">ffmpeg -i video.gif -b:v 0 -crf 22 video.mp4</code></pre></div>\n<p>Esto nos deja un archivo de <strong>8,5MB</strong>, reduciendo su peso a un 13% del original.</p>\n<h3 id=\"webm\">WebM</h3>\n<p>Otro formato de v√≠deo es <strong>WebM</strong>, la versi√≥n para v√≠deos de <strong>WebP</strong>, el formato de imagen con p√©rdida sugerido por Google. El formato WebM tiene un gran soporte por los navegadores, como podemos ver en <a href=\"https://caniuse.com/#search=webm\">Can I Use</a>.</p>\n<p>Despu√©s de hacer algunas pruebas ajustando  el valor de CRF, lo establecemos al valor sugerido por Google, 41:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">ffmpeg -i video.gif -c vp9 -b:v 0 -crf 41 video.webm</code></pre></div>\n<p>Sorprendentemente obtenemos un v√≠deo de una calidad muy aceptable con un tama√±o de s√≥lo <strong>2,4MB</strong>.</p>\n<h3 id=\"video\">&#x3C;video></h3>\n<p>A la hora de implementar estos formatos, y para dar soporte a todos los navegadores, a√±adiremos m√∫ltiples sources a una etiqueta v√≠deo:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>video</span> <span class=\"token attr-name\">autoplay</span> <span class=\"token attr-name\">loop</span> <span class=\"token attr-name\">muted</span> <span class=\"token attr-name\">playsinline</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>video.webm<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>video/webm<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>video.mp4<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>video/mp4<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>video</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Esto permite servir el archivo <strong>video.webm</strong> para los navegadores que soporten WebM y <strong>video.mp4</strong> para el resto.</p>\n<h2 id=\"conclusion\">Conclusi√≥n</h2>\n<p>Hemos visto c√≥mo podemos mejorar el rendimiento de esta p√°gina con unos simples pasos. Pero lo que realmente deber√≠amos valorar es el impacto en la experiencia de usuario, dado que este v√≠deo se muestra en la p√°gina de login, una funcionalidad cr√≠tica.</p>\n<p>En el caso de que un usuario acceda desde m√≥vil, podr√≠amos presentar una imagen en lugar de un v√≠deo, ya que en la mayor√≠a de casos estar√° navegado en una red de datos.</p>\n<p>Somos conscientes de que m√°s del 90% de usuarios acceder√°n a la siguiente pantalla antes de que haya descargado el 100% del GIF, pero hemos de ser responsables con el consumo de datos de los usuarios cuando acceden a nuestras webs o aplicaciones.</p>","frontmatter":{"title":"El formato v√≠deo en la web","date":"August 26, 2019","description":"Despu√©s de encontrarnos con la imagen m√°s pesada de la web (seg√∫n HTTP Archive), no hemos resistido la tentaci√≥n de analizar el caso y encontrar una soluci√≥n para mejorar el rendimiento.","featuredImage":{"childImageSharp":{"fluid":{"aspectRatio":1,"src":"/static/785076bd1a8e6bcc85b2f2fffef9ac88/c2a4f/featured-image.png","srcSet":"/static/785076bd1a8e6bcc85b2f2fffef9ac88/a3004/featured-image.png 250w,\n/static/785076bd1a8e6bcc85b2f2fffef9ac88/90fcb/featured-image.png 500w,\n/static/785076bd1a8e6bcc85b2f2fffef9ac88/c2a4f/featured-image.png 1000w,\n/static/785076bd1a8e6bcc85b2f2fffef9ac88/24599/featured-image.png 1500w,\n/static/785076bd1a8e6bcc85b2f2fffef9ac88/024a5/featured-image.png 2000w,\n/static/785076bd1a8e6bcc85b2f2fffef9ac88/4e77b/featured-image.png 2134w","sizes":"(max-width: 1000px) 100vw, 1000px"}}}}}},"pageContext":{"slug":"/blog/video-en-la-web/","previous":{"fields":{"slug":"/blog/mantenerse-al-dia/"},"frontmatter":{"title":"C√≥mo mantenerse al d√≠a sobre rendimiento web"}},"next":null}}