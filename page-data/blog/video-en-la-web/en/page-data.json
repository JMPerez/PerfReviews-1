{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/video-en-la-web/en/","webpackCompilationHash":"4ee8b307865fbeeb9263","result":{"data":{"site":{"siteMetadata":{"title":"PerfReviews","author":"Joan Le√≥n y Jos√© M. P√©rez"}},"markdownRemark":{"id":"c8a5da11-8155-5815-ac9a-573cba2b06f8","excerpt":"We came across this tweet by Yoav Weiss in which Addy Osmani asks about the ‚Äúbest‚Äù image on the web:  Rick Viscomi is an Engineer at Google who is currently‚Ä¶","html":"<p>We came across this tweet by <a href=\"https://twitter.com/yoavweiss\">Yoav Weiss</a> in which <a href=\"https://twitter.com/addyosmani\">Addy Osmani</a> asks about the ‚Äúbest‚Äù image on the web:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1240px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/28cbb92632f50d041418b0179574a14a/7bfa5/Yoav.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 114.51612903225808%; position: relative; bottom: 0; left: 0; background-image: url('data:image/svg+xml,%3csvg%20xmlns=\\'http://www.w3.org/2000/svg\\'%20width=\\'400\\'%20height=\\'458\\'%3e%3cpath%20d=\\'M26%2016c-13%206-13%2023-1%2029%2016%207%2030-11%2019-24-4-6-12-7-18-5m-8%2064c-3%204%200%209%204%207%202-2%203-2%204%200%201%201%202%201%204-1s2-3%200-5-2-2-4-1c-2%202-2%202-3%200h-5m85%2061c0%201%200%202-1%201l-2-1-2%201h-1c-1-1-1-1-2%201h-1c0-2-2-3-2-1h-4c-1%201-2%201-2-1l-3-1c-3%200-3%200-3%204%200%203%202%204%205%202h2c2%202%204%201%204-1l1-2%201%202c1%202%203%203%203%200h2c2%202%204%202%204%200h1c0%204%202%202%202-2s-2-6-2-2M28%20394l-2%205c-1%204-1%2012%201%2014%203%201%202%202%200%202l-7%203%204%203c4%203%2011%203%2016%201%204-3%205-4%201-7-4-4-5-6-2-8l1-6c0-4%200-5-3-6-4-2-9-2-9-1\\'%20fill=\\'%23d3d3d3\\'%20fill-rule=\\'evenodd\\'/%3e%3c/svg%3e'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/28cbb92632f50d041418b0179574a14a/277cf/Yoav.webp 310w,\n/static/28cbb92632f50d041418b0179574a14a/5077d/Yoav.webp 620w,\n/static/28cbb92632f50d041418b0179574a14a/e1adb/Yoav.webp 1240w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/28cbb92632f50d041418b0179574a14a/fa223/Yoav.png 310w,\n/static/28cbb92632f50d041418b0179574a14a/a5ed1/Yoav.png 620w,\n/static/28cbb92632f50d041418b0179574a14a/7bfa5/Yoav.png 1240w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/28cbb92632f50d041418b0179574a14a/7bfa5/Yoav.png\"\n          alt=\"Tweet Yoav &amp; Addy\"\n          title=\"Tweet Yoav &amp; Addy\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Tweet Yoav &amp; Addy</figcaption>\n  </figure></p>\n<p><a href=\"https://twitter.com/rick_viscomi\">Rick Viscomi</a> is an Engineer at Google who is currently working on an interesting project called ‚ÄúThe State of the Web‚Äù. For this initiative, Rick is running hundreds of queries <a href=\"https://cloud.google.com/bigquery/\">BigQuery</a> against the dataset <a href=\"https://httparchive.org\">HTTP Archive</a>, and replies to Addy with the following tweet:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1240px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/161f746459bb8584f488b60edda996c1/7bfa5/Rick.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 106.4516129032258%; position: relative; bottom: 0; left: 0; background-image: url('data:image/svg+xml,%3csvg%20xmlns=\\'http://www.w3.org/2000/svg\\'%20width=\\'400\\'%20height=\\'426\\'%3e%3cpath%20d=\\'M24%2016c-10%206-10%2020%200%2027%205%203%208%203%2013-2l5-3V17c-1-3-14-4-18-1m7%203c-2%202-3%205-1%205l1%204c-1%204%201%205%203%203%201-2%201-2%203%201%202%202%202%202%203%200%204-7-3-17-9-13M21%20218v8l1%207h25c33%200%2030%201%2030-8v-7l-28-1-28%201m74%2068c0%201-1%202-3%202l-2%201c0%202%2012%202%2012%200l1%201%201%202v-4l1%202h2l12%201h11l1%201%208-1c1%202%206%200%206-2h1c0%202%209%202%2010%200%200-2-5-3-11-2a376%20376%200%2001-31%200l-17-1h-2m166%200l-1%203v2h15c11%200%2014-1%2015-2s1-1%201%201c1%201%201%201%201-1l-1-3h-3c-1-1-1-1-2%201l-1%201c0-2-2-3-2-1h-1c-1-2-2-2-2-1h-2c-2-1-13-1-14%201h-1c0-1-1-2-2-1m-215%203c0%202%200%202%201%201l1-1c0%201%202%202%206%202h5l5-1h5l1-1c0%203%2017%203%2017%200%200-2-4-3-7-2H67c-4-1-4-1-5%201l-1%202-1-2c1-1%200-1-2-1h-7c-5-1-5-1-5%202m152-1c0%202%201%202%204%203l3-1h1c3%201%2011%201%2012-1h1c0%201%201%202%204%202h5c1%202%206%200%206-2h1c0%202%204%203%204%201h1c1%201%201%201%201-1h1c0%204%2013%203%2014%200%201-2%201-2%202%200l1%203v-3c0-2%200-3-2-3l-2%201h-6a332%20332%200%2000-45%200h-4c-2-1-2-1-2%201m42%20113c-2%202%201%208%204%209%203%200%207-4%207-8%200-2-1-3-5-3l-6%202\\'%20fill=\\'%23d3d3d3\\'%20fill-rule=\\'evenodd\\'/%3e%3c/svg%3e'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/161f746459bb8584f488b60edda996c1/277cf/Rick.webp 310w,\n/static/161f746459bb8584f488b60edda996c1/5077d/Rick.webp 620w,\n/static/161f746459bb8584f488b60edda996c1/e1adb/Rick.webp 1240w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/161f746459bb8584f488b60edda996c1/fa223/Rick.png 310w,\n/static/161f746459bb8584f488b60edda996c1/a5ed1/Rick.png 620w,\n/static/161f746459bb8584f488b60edda996c1/7bfa5/Rick.png 1240w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/161f746459bb8584f488b60edda996c1/7bfa5/Rick.png\"\n          alt=\"Tweet Rick\"\n          title=\"Tweet Rick\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Tweet Rick</figcaption>\n  </figure></p>\n<p>Rick shows the SQL query he has run against the HTTP Archive dataset for the month of July.</p>\n<p>The ‚Äúbest‚Äù image of the web is currently a file in GIF format, video.gif. As the name implies, it is a video of 11 seconds and with a size of more than <strong>65Mb</strong>.</p>\n<p>Yes, we were curious üòä</p>\n<p>So we started doing what we like to do: research to find the problem and its possible solution.</p>\n<h2 id=\"problem\">Problem</h2>\n<p>Based on the URL of the image, the first thing we can see is that it is a <a href=\"https://moodle.org\">Moodle</a>, an online learning platform used by many schools around the world.</p>\n<p>When entering the address <a href=\"https://moodle.e-formalia.es\">moodle.e-formalia.es</a> we get a login page to the platform, and that is where we find the heavy GIF.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1240px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7a0242c50970cf62c34468bd6dea54a4/140d6/home.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.2814371257485%; position: relative; bottom: 0; left: 0; background-image: url('data:image/svg+xml,%3csvg%20xmlns=\\'http://www.w3.org/2000/svg\\'%20width=\\'400\\'%20height=\\'237\\'%3e%3cpath%20d=\\'M143%201c-2%203-2%204%200%207l2%2011%201%209%2037%207c7%201%208%202%203%207-6%206-7%2011-3%2018l3%209c3%2013%205%2017%2011%2020l6%204-4%206c-2-1-2-1%200-4%200-2-1-2-2%201-4%203-4%204%200%204%204%201%204%203-2%207l-4%205h4l11-1%2014-1h15c1-2%2011-5%2013-5l-2%202c-2%203-4%2012-3%2013l1-2%201-4c2-3%202-3%203-1l2%201-1-2c-1-2%200-2%202-2%203-1%204%200%204%201l1%203%201-2c0-3%200-3%207-2l9%201c4%201%2011%202%2015%201%202-1%203%200%203%201l2%202c2%200%203-3%201-3-1-1%200-1%201-1l2%201h1c0-1%202%200%205%204l5%204-4-5c-4-4-4-5-3-6l1-1%202-2c3-2%203-2%201-2l-3-1c0-1%209-1%2012%201h-2l-4%201%203%201%202%201h3c1-1%203-2%204-1%204%201%204-1-1-3h2l5-1%203-1c3%200%203%200%202%201v2c1%200%204-3%202-3l5-2%202%202c1%201%200%201-2%201h-3c0%201%205%202%207%201l1-2h1l1-1h2l3%202%2041-5h9V63a1660%201660%200%20010-47c0%206-1%208-2%208-1-1-3%200-4%201s-2%202-3%201l-2%201-2%201-2%202-1%201c-1-1-7%201-7%202l-2%202-3%201-3%201-6%203-1%201h-3c-1%202-8%203-8%202h-1c0%203-3%204-10%205-5%200-7-1-8-2h-13l-3-1-4-1-8-1c0-2-1-2-4-2a86%2086%200%2001-9-1l-2-2h-1l-2%201-9-3c0-2-4-1-8%201-3%202-4%202-6%201h-2v3h-2c1%202-7%205-11%206l-5%201c-2%202-14%202-19-1l-7-2-2-2c0-2%204-4%2016-10%204-2%206-4%207-6l7-13c7-14%208-17%200-5-6%2010-8%209-2-2l4-7h-7c-9%201-9%201-13%204l-7%202-5%203-5%203-4%202h-4l-11-2h-4l-5%201c-3%201-3-1-1-3l11-5%2010-5-59%201m121%201l-3%201c-2%200-7%204-9%208l-6%209c-10%2010-7%2011%207%203l10-5c8-2%2018-8%2014-8l-2%201c-2%202-4%201-4-1%201-2%201-2-2-2h-4c-1%201-1%201-1-1%203-5%203-7%202-7l-2%202M146%20130H0v107h401V130H146M0%20184\\'%20fill=\\'%23d3d3d3\\'%20fill-rule=\\'evenodd\\'/%3e%3c/svg%3e'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/7a0242c50970cf62c34468bd6dea54a4/277cf/home.webp 310w,\n/static/7a0242c50970cf62c34468bd6dea54a4/5077d/home.webp 620w,\n/static/7a0242c50970cf62c34468bd6dea54a4/e1adb/home.webp 1240w,\n/static/7a0242c50970cf62c34468bd6dea54a4/92eb6/home.webp 1860w,\n/static/7a0242c50970cf62c34468bd6dea54a4/d232f/home.webp 2480w,\n/static/7a0242c50970cf62c34468bd6dea54a4/8d80f/home.webp 3340w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/7a0242c50970cf62c34468bd6dea54a4/fa223/home.png 310w,\n/static/7a0242c50970cf62c34468bd6dea54a4/a5ed1/home.png 620w,\n/static/7a0242c50970cf62c34468bd6dea54a4/7bfa5/home.png 1240w,\n/static/7a0242c50970cf62c34468bd6dea54a4/b429f/home.png 1860w,\n/static/7a0242c50970cf62c34468bd6dea54a4/d03be/home.png 2480w,\n/static/7a0242c50970cf62c34468bd6dea54a4/140d6/home.png 3340w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/7a0242c50970cf62c34468bd6dea54a4/7bfa5/home.png\"\n          alt=\"Home e-Formalia\"\n          title=\"Home e-Formalia\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Home e-Formalia</figcaption>\n  </figure></p>\n<p>The server is serving us two images: logos.png and video.gif. The loading time of that background video on the access screen, from a fiber optic connection of <strong>600Mb</strong> is only <strong>2.67 seconds</strong>.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1240px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3386e8063e1887c0285f0edef7b5ec66/a987b/network-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/svg+xml,%3csvg%20xmlns=\\'http://www.w3.org/2000/svg\\'%20width=\\'400\\'%20height=\\'196\\'%3e%3cpath%20d=\\'M96%2043a256%20256%200%20001%2016l1-9%2014%201c10%201%2013%200%2015-1s0-1-13-1l-17-1a6329%206329%200%2001109-1%201314%201314%200%2001-96-4H96m-75%201h20v5h23c22%200%2022-1%2022-2l-1-3a936%20936%200%2000-64%200m376%2088v54l1-53a872%20872%200%2000-1-1M1%20106v10h316V95H1v11m1%200v8h314V97H2v9m230%2084a494%20494%200%200147%200h-16l-8-1h-8l-2-1-3%201h-3l-2%201c1-1%200-2-2-2-3%200-3%200-3%202\\'%20fill=\\'%23d3d3d3\\'%20fill-rule=\\'evenodd\\'/%3e%3c/svg%3e'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/3386e8063e1887c0285f0edef7b5ec66/277cf/network-1.webp 310w,\n/static/3386e8063e1887c0285f0edef7b5ec66/5077d/network-1.webp 620w,\n/static/3386e8063e1887c0285f0edef7b5ec66/e1adb/network-1.webp 1240w,\n/static/3386e8063e1887c0285f0edef7b5ec66/92eb6/network-1.webp 1860w,\n/static/3386e8063e1887c0285f0edef7b5ec66/34ef4/network-1.webp 1920w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/3386e8063e1887c0285f0edef7b5ec66/fa223/network-1.png 310w,\n/static/3386e8063e1887c0285f0edef7b5ec66/a5ed1/network-1.png 620w,\n/static/3386e8063e1887c0285f0edef7b5ec66/7bfa5/network-1.png 1240w,\n/static/3386e8063e1887c0285f0edef7b5ec66/b429f/network-1.png 1860w,\n/static/3386e8063e1887c0285f0edef7b5ec66/a987b/network-1.png 1920w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/3386e8063e1887c0285f0edef7b5ec66/7bfa5/network-1.png\"\n          alt=\"Developer Tools: Network Panel\"\n          title=\"Developer Tools: Network Panel\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Developer Tools: Network Panel</figcaption>\n  </figure></p>\n<p>Let‚Äôs see what happens if we use the functionality of the Developer Tools network panel to simulate a slower connection. We select the fast 3G preset, which is closer to a mobile experience.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1240px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ae44d5483768a8b0262bf4e9680b1069/a987b/network-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/svg+xml,%3csvg%20xmlns=\\'http://www.w3.org/2000/svg\\'%20width=\\'400\\'%20height=\\'196\\'%3e%3cpath%20d=\\'M4%2054c0%2011%200%2012%201%206%200-6%201-7%202-7%203%200%202-2%200-3-1-1%2076-1%20173-1h175v19l1-7V47c0-5-1-6-1-3v4H181A6270%206270%200%20016%2045v-1l-1-2c-1-1-1%205-1%2012m-3%2051v9h314l1-9v-9H1v9m2-1v5h5l4-1-4-1c-4%200-4%200-4-3%200-2%200-2%204-2h4c1-1%201%201%201%204v5H8l-5%201%20156%201h156V98H3v6m232%2086a504%20504%200%200147%200h-16l-7-1-8%201-2%201c-2%200-2%200-1-1%201-2%201-2-1-2l-2%201h-4l-1%202v-1c2-3%200-2-3%200h-1v-2l-1%202\\'%20fill=\\'%23d3d3d3\\'%20fill-rule=\\'evenodd\\'/%3e%3c/svg%3e'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/ae44d5483768a8b0262bf4e9680b1069/277cf/network-2.webp 310w,\n/static/ae44d5483768a8b0262bf4e9680b1069/5077d/network-2.webp 620w,\n/static/ae44d5483768a8b0262bf4e9680b1069/e1adb/network-2.webp 1240w,\n/static/ae44d5483768a8b0262bf4e9680b1069/92eb6/network-2.webp 1860w,\n/static/ae44d5483768a8b0262bf4e9680b1069/34ef4/network-2.webp 1920w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/ae44d5483768a8b0262bf4e9680b1069/fa223/network-2.png 310w,\n/static/ae44d5483768a8b0262bf4e9680b1069/a5ed1/network-2.png 620w,\n/static/ae44d5483768a8b0262bf4e9680b1069/7bfa5/network-2.png 1240w,\n/static/ae44d5483768a8b0262bf4e9680b1069/b429f/network-2.png 1860w,\n/static/ae44d5483768a8b0262bf4e9680b1069/a987b/network-2.png 1920w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/ae44d5483768a8b0262bf4e9680b1069/7bfa5/network-2.png\"\n          alt=\"Developer Tools: Network Panel\"\n          title=\"Developer Tools: Network Panel\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Developer Tools: Network Panel</figcaption>\n  </figure></p>\n<p>We had to wait <strong>6.1 minutes</strong> to fully download the video.</p>\n<h2 id=\"solution\">Solution</h2>\n<p>It is not a novelty that the best format for loading a video on the web is a video format like <strong>MP4</strong>, instead of an image with support for animations like the <strong>GIF</strong> format. </p>\n<p>There are other image formats that support animation, such as <strong>WebM</strong>. There is also the format <strong>APNG</strong>. This format, which is not new but is very unknown, is a PNG version with support for animations. Recently Joan mentioned it in  <a href=\"https://twitter.com/nucliweb/status/1163537269007032320\">this tweet</a>.</p>\n<p>To learn about using Video instead of GIF, we can use one of the best resources for good practices in web performance, <strong>Web Fundamentals</strong>. On this website we find a specific article on this topic <a href=\"https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/replace-animated-gifs-with-video/\">Replace Animated GIFs with Video</a>.</p>\n<p>The article recommends using a video compression tool, <a href=\"https://ffmpeg.org\">FFmpeg</a>. It is a very powerful and versatile tool, with many features, plugins and endless possibilities to customize. To make it easy we will focus on the suggestions Google makes in that article.</p>\n<h3 id=\"mpeg-4\">MPEG-4</h3>\n<p>We install ffmpeg (in our case as easy as running <code class=\"language-text\">brew install ffmpeg</code> on Mac), and we run <code class=\"language-text\">ffmpeg -i video.gif video.mp4</code>. After a few seconds we can see that the file <strong>video.gif</strong> of <strong>65Mb</strong> has become video.mp4 of only <strong>6.6Mb</strong>. In the article they show some parameters of FFmpeg that give us the option to optimize the conversion from the point of view of weight and quality.</p>\n<p>We can adjust the parameter <a href=\"https://trac.ffmpeg.org/wiki/Encode/H.264\">CRF</a> that allows us to define the level of quality loss. After some tests, we decide to set the CRT at 22, one point below the default value, with the intention of being as faithful as possible to the quality of the original file.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">ffmpeg -i video.gif -b:v 0 -crf 22 video.mp4</code></pre></div>\n<p>This leaves us a file of <strong>8.5Mb</strong>, reducing its weight 13% in comparison to the original GIF.</p>\n<h3 id=\"webm\">WebM</h3>\n<p>Another video format is <strong>WebM</strong>, the video version of <strong>WebP</strong>, a lossy image format recommended by Google. The WebM format has great browser support as we can see on <a href=\"https://caniuse.com/#search=webm\">Can I Use</a>.</p>\n<p>After doing some tests by adjusting the value of CRF, we set it to the value suggested by Google, 41:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">ffmpeg -i video.gif -c vp9 -b:v 0 -crf 41 video.webm</code></pre></div>\n<p>Surprisingly, we get a video of a very acceptable quality with a size of only <strong>2.4Mb</strong>.</p>\n<h3 id=\"video\">&#x3C;video></h3>\n<p>When implementing these formats, and to support all browsers, we will add multiple sources to a video tag:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>video</span> <span class=\"token attr-name\">autoplay</span> <span class=\"token attr-name\">loop</span> <span class=\"token attr-name\">muted</span> <span class=\"token attr-name\">playsinline</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>video.webm<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>video/webm<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>video.mp4<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>video/mp4<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>video</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>This will render <strong>video.webm</strong> on those browsers supporting WebM, and <strong>video.mp4</strong> on the rest.</p>\n<h2 id=\"result\">Result</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1240px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6b529192a33f442b3dfecfa84c22f3d0/fb323/terminal-files.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.168539325842694%; position: relative; bottom: 0; left: 0; background-image: url('data:image/svg+xml,%3csvg%20xmlns=\\'http://www.w3.org/2000/svg\\'%20width=\\'400\\'%20height=\\'141\\'%3e%3cpath%20d=\\'M0%201v71l1%2069h198l201-1%201-71a880%20880%200%2000-2-68C399-1%201-1%200%201m133%2096v4l-1%201-1%201%207%201%207-1h12c0%202%203%201%203-1h1l1%202v-3l1-1%201%202c0%202%200%202%201%201%200-1%201-2%203-1l2-1-2-1-4-1h-24v-2c0-1-4%202-4%204%200%203-2%201-2-2s-1-3-1-2m39%202v4h8l3-1%203%201h5l6%201c4%200%205%200%206-4l1-3-2%203c-2%203-2%203-2%201s-4-6-5-4c0%201-1%202-3%201l-3%201h-9c-2-2-4-1-4%201-1%203-3%202-3-1l-1-3v3m54-1h-3l-3%201-1%202v-1l-1-2-3%202-1%201v-1c0-1-1-2-4-2s-4%201-4%202v2c0%201%201%202%204%202l4-1h7c1%201%204%201%204-1v-1l1%201c1%203%203%202%203-1-1-3-2-5-3-3\\'%20fill=\\'%23d3d3d3\\'%20fill-rule=\\'evenodd\\'/%3e%3c/svg%3e'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/6b529192a33f442b3dfecfa84c22f3d0/277cf/terminal-files.webp 310w,\n/static/6b529192a33f442b3dfecfa84c22f3d0/5077d/terminal-files.webp 620w,\n/static/6b529192a33f442b3dfecfa84c22f3d0/e1adb/terminal-files.webp 1240w,\n/static/6b529192a33f442b3dfecfa84c22f3d0/b9128/terminal-files.webp 1780w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/6b529192a33f442b3dfecfa84c22f3d0/fa223/terminal-files.png 310w,\n/static/6b529192a33f442b3dfecfa84c22f3d0/a5ed1/terminal-files.png 620w,\n/static/6b529192a33f442b3dfecfa84c22f3d0/7bfa5/terminal-files.png 1240w,\n/static/6b529192a33f442b3dfecfa84c22f3d0/fb323/terminal-files.png 1780w\"\n          sizes=\"(max-width: 1240px) 100vw, 1240px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/6b529192a33f442b3dfecfa84c22f3d0/7bfa5/terminal-files.png\"\n          alt=\"terminal files\"\n          title=\"terminal files\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>We leave you a link to the files so you can evaluate the quality results, as well as their sizes.</p>\n<ul>\n<li><a href=\"/a3c782d22c253fe59a1b92aa63fe0726/video.gif\">video.gif (65Mb)</a></li>\n<li><a href=\"/6b45cc354d7ae59ecd006f8708b802ba/video.mp4\">video.mp4 (8,5Mb)</a></li>\n<li><a href=\"/f6a8d6e3a8f2d1964382adfb966a1826/video.webm\">video.webm (2,4Mb)</a></li>\n</ul>\n<h2 id=\"conclusion\">Conclusion</h2>\n<p>We have seen how we can improve the performance of a page with a few simple steps. More importantly, this represents an improvement in user experience, since this video is shown on the login page, a critical functionality.</p>\n<p>As a further improvement, when a user accesses the site from mobile or on a slow connection, we could render an image instead of a video.</p>\n<p>We are aware that most users will navigate to another page before they have downloaded the whole GIF. Still, we should strive for not serving more data than needed, reducing costs of CDN and resources for both users and servers.</p>","frontmatter":{"title":"The video format on the web","date":"August 28, 2019","description":"After founding the heaviest image on the web (according to HTTP Archive), we have not resisted the temptation to dig further and figure out what went wrong and alternatives to serve a lighter alternative.","featuredImage":{"childImageSharp":{"fluid":{"aspectRatio":1,"src":"/static/785076bd1a8e6bcc85b2f2fffef9ac88/e9c7b/featured-image.png","srcSet":"/static/785076bd1a8e6bcc85b2f2fffef9ac88/69781/featured-image.png 250w,\n/static/785076bd1a8e6bcc85b2f2fffef9ac88/3fa08/featured-image.png 500w,\n/static/785076bd1a8e6bcc85b2f2fffef9ac88/e9c7b/featured-image.png 1000w,\n/static/785076bd1a8e6bcc85b2f2fffef9ac88/a4fe2/featured-image.png 1500w,\n/static/785076bd1a8e6bcc85b2f2fffef9ac88/dc9f7/featured-image.png 2000w,\n/static/785076bd1a8e6bcc85b2f2fffef9ac88/c81f1/featured-image.png 2134w","sizes":"(max-width: 1000px) 100vw, 1000px"}}}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/video-en-la-web/en/","previous":{"fields":{"slug":"/blog/video-en-la-web/"},"frontmatter":{"title":"El formato v√≠deo en la web"}},"next":{"fields":{"slug":"/blog/image-optimization/"},"frontmatter":{"title":"¬øPor d√≥nde empiezo para optimizar mis im√°genes?"}}}}}